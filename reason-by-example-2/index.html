<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'Inter','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Inter','Georgia',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Inter, Georgia, sanf-serif;font-weight:800;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Inter, Georgia, sanf-serif;font-weight:800;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Inter, Georgia, sanf-serif;font-weight:800;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Inter, Georgia, sanf-serif;font-weight:800;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Inter, Georgia, sanf-serif;font-weight:800;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Inter','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:hsla(0,0%,0%,0.59);font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:#007acc;text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}</style><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png"/><meta name="generator" content="Gatsby 2.3.25"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png"/><title data-react-helmet="true">Javascript Interop, Options And Error Handling - ReasonML By Example | Oleksandr Dubenko</title><meta data-react-helmet="true" name="description" content="Implementing quadtree visualization in ReasonML"/><meta data-react-helmet="true" property="og:title" content="Javascript Interop, Options And Error Handling - ReasonML By Example"/><meta data-react-helmet="true" property="og:description" content="Implementing quadtree visualization in ReasonML"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Oleksandr Dubenko"/><meta data-react-helmet="true" name="twitter:title" content="Javascript Interop, Options And Error Handling - ReasonML By Example"/><meta data-react-helmet="true" name="twitter:description" content="Implementing quadtree visualization in ReasonML"/><meta data-react-helmet="true" name="twitter:image"/><meta data-react-helmet="true" name="og:image"/><style data-href="/styles.d14f14c427bee3c8e4b4.css">code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}pre[class*=language-]{border-radius:6px;box-shadow:0 5px 12px rgba(0,0,0,.2);margin:.2em 0 2em!important}pre[class*=language-reason]{border-left:5px solid #dd4b39}pre[class*=language-typescript]{border-left:5px solid #71a0e0}:not(pre)>code[class*=language-]{background:#eee!important;color:#333}.gatsby-highlight-code-line{background-color:#444;display:block;margin-right:-1em;margin-left:-1em;padding-right:1em;padding-left:1em}@font-face{font-family:Inter;font-style:normal;font-weight:100;font-display:swap;src:url(/static/Inter-Thin-BETA-9e3124cb85516646a4654757c5c2f125.woff2) format("woff2"),url(/static/Inter-Thin-BETA-93ef2254d41ece1d04166cc29b599458.woff) format("woff")}@font-face{font-family:Inter;font-style:italic;font-weight:100;font-display:swap;src:url(/static/Inter-ThinItalic-BETA-1069fd9871e848b54e930e4771839ebd.woff2) format("woff2"),url(/static/Inter-ThinItalic-BETA-a65720437b6a770ccaffae97c8bd67b9.woff) format("woff")}@font-face{font-family:Inter;font-style:normal;font-weight:200;font-display:swap;src:url(/static/Inter-ExtraLight-BETA-e077c15e5c2d5f9e70e7c537e6f87c52.woff2) format("woff2"),url(/static/Inter-ExtraLight-BETA-a09af54a43cae85600f0f10583ad19fb.woff) format("woff")}@font-face{font-family:Inter;font-style:italic;font-weight:200;font-display:swap;src:url(/static/Inter-ExtraLightItalic-BETA-98d59f4e6d4228ba696516c5717c1cb9.woff2) format("woff2"),url(/static/Inter-ExtraLightItalic-BETA-5be26fde07593fcad7123610d055a33c.woff) format("woff")}@font-face{font-family:Inter;font-style:normal;font-weight:300;font-display:swap;src:url(/static/Inter-Light-BETA-7f67ab6aeebccf32e1fdc69b4b9a01de.woff2) format("woff2"),url(/static/Inter-Light-BETA-39a510c28179c25e0e4f65524d8d5394.woff) format("woff")}@font-face{font-family:Inter;font-style:italic;font-weight:300;font-display:swap;src:url(/static/Inter-LightItalic-BETA-eabe5d072b56b38a23c37e1b991c215d.woff2) format("woff2"),url(/static/Inter-LightItalic-BETA-8c35c38451d802f149fcbc7e9004193e.woff) format("woff")}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(/static/Inter-Regular-55c843b0b146c9d1db049e4751172fe1.woff2) format("woff2"),url(/static/Inter-Regular-da83100fc42a3c359ae8e3038a4a5e90.woff) format("woff")}@font-face{font-family:Inter;font-style:italic;font-weight:400;font-display:swap;src:url(/static/Inter-Italic-c93e619c54ac4d58a06e3deb35b1724a.woff2) format("woff2"),url(/static/Inter-Italic-88b63c27cdce33467477f6b31373c11b.woff) format("woff")}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(/static/Inter-Medium-28aa0d261b04149285b4ec9850b7ae97.woff2) format("woff2"),url(/static/Inter-Medium-70f84e39477b8c33dbc1900a4bacb20f.woff) format("woff")}@font-face{font-family:Inter;font-style:italic;font-weight:500;font-display:swap;src:url(/static/Inter-MediumItalic-c85c7276ae2b89bc5aadf1b1cb256291.woff2) format("woff2"),url(/static/Inter-MediumItalic-de9b0866cf73188ae7ca0292a439d6a4.woff) format("woff")}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(/static/Inter-SemiBold-29ffb154034cf8fa1cec51557410cd9c.woff2) format("woff2"),url(/static/Inter-SemiBold-548fae5eac276c84e8e47658147c1dd0.woff) format("woff")}@font-face{font-family:Inter;font-style:italic;font-weight:600;font-display:swap;src:url(/static/Inter-SemiBoldItalic-f16075d6b7a83fcf59912b1b1aa716e3.woff2) format("woff2"),url(/static/Inter-SemiBoldItalic-f576c8b25d49a2b711be3760e7be4022.woff) format("woff")}@font-face{font-family:Inter;font-style:normal;font-weight:700;font-display:swap;src:url(/static/Inter-Bold-2126cfb653b81bad8401da0a98c6bd25.woff2) format("woff2"),url(/static/Inter-Bold-b788e8a0ec2b2ab3fe6f0d17e4508835.woff) format("woff")}@font-face{font-family:Inter;font-style:italic;font-weight:700;font-display:swap;src:url(/static/Inter-BoldItalic-d5e790be1041e248afed3159b60a25a8.woff2) format("woff2"),url(/static/Inter-BoldItalic-ebef654642ae42ba62e081cb7c9799d1.woff) format("woff")}@font-face{font-family:Inter;font-style:normal;font-weight:800;font-display:swap;src:url(/static/Inter-ExtraBold-d0fd9c08d2b44835955362c62856afaa.woff2) format("woff2"),url(/static/Inter-ExtraBold-120ea2c83162244cf5f1e3e95e42a4a7.woff) format("woff")}@font-face{font-family:Inter;font-style:italic;font-weight:800;font-display:swap;src:url(/static/Inter-ExtraBoldItalic-9ae74c8dc9ad0ddc874c9af9b7bb96ac.woff2) format("woff2"),url(/static/Inter-ExtraBoldItalic-58948c2c7a1c604287e36da46a9b26ac.woff) format("woff")}@font-face{font-family:Inter;font-style:normal;font-weight:900;font-display:swap;src:url(/static/Inter-Black-24af3021b18bdaa5c0edd079259e887d.woff2) format("woff2"),url(/static/Inter-Black-abaeaaad10bd44e916afa871d0905620.woff) format("woff")}@font-face{font-family:Inter;font-style:italic;font-weight:900;font-display:swap;src:url(/static/Inter-BlackItalic-f0844cf1cccc5f8ab4ddb8c3cf66cf5c.woff2) format("woff2"),url(/static/Inter-BlackItalic-b2f912ae1e6328973104ebcc98b01088.woff) format("woff")}@font-face{font-family:Inter var;font-weight:100 900;font-display:swap;font-style:normal;font-named-instance:"Regular";src:url(/static/Inter-upright.var-2f136faf2d0ef6368898d1a515ab707c.woff2) format("woff2")}@font-face{font-family:Inter var;font-weight:100 900;font-display:swap;font-style:italic;font-named-instance:"Italic";src:url(/static/Inter-italic.var-ecdb2a78e09c264297f5af21c0246657.woff2) format("woff2")}@font-face{font-family:Inter var experimental;font-weight:100 900;font-display:swap;font-style:oblique 0deg 10deg;src:url(/static/Inter.var-dee04fd5283594db33b54145bbe5171c.woff2) format("woff2")}</style><link as="script" rel="preload" href="/component---src-templates-blog-post-js-d6c4ff3997a89bd5bda3.js"/><link as="script" rel="preload" href="/1-1548207ea9ee4c2f8cde.js"/><link as="script" rel="preload" href="/app-898795e671bc05935a90.js"/><link as="script" rel="preload" href="/styles-fb3fb444cf5b3d203f66.js"/><link as="script" rel="preload" href="/webpack-runtime-e5556ddc2c858ebe804f.js"/><link as="fetch" rel="preload" href="/static/d/271/path---reason-by-example-2-786-ea5-lituBrqrWSGYtv3EBns36JNbgE.json" crossorigin="use-credentials"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div style="margin-left:auto;margin-right:auto;max-width:45.5rem;padding:2.625rem 1.3125rem"><header><h3 style="margin-top:0;font-weight:600;display:flex;align-items:center;justify-content:space-between"><a style="box-shadow:none;text-decoration:none;color:inherit;font-weight:700" href="/">Oleksandr Dubenko</a><a href="http://twitter.com/dubenko_" style="display:flex;height:40px;font-size:16px;align-items:center;text-decoration:none;box-shadow:none"><div style="height:32px;width:32px;margin-top:1px"><svg id="Logo_FIXED" data-name="Logo — FIXED" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 400"><defs></defs><path class="cls-2" fill="currentColor" d="M153.62,301.59c94.34,0,145.94-78.16,145.94-145.94,0-2.22,0-4.43-.15-6.63A104.36,104.36,0,0,0,325,122.47a102.38,102.38,0,0,1-29.46,8.07,51.47,51.47,0,0,0,22.55-28.37,102.79,102.79,0,0,1-32.57,12.45,51.34,51.34,0,0,0-87.41,46.78A145.62,145.62,0,0,1,92.4,107.81a51.33,51.33,0,0,0,15.88,68.47A50.91,50.91,0,0,1,85,169.86c0,.21,0,.43,0,.65a51.31,51.31,0,0,0,41.15,50.28,51.21,51.21,0,0,1-23.16.88,51.35,51.35,0,0,0,47.92,35.62,102.92,102.92,0,0,1-63.7,22A104.41,104.41,0,0,1,75,278.55a145.21,145.21,0,0,0,78.62,23"></path></svg></div></a></h3></header><main><h1>Javascript Interop, Options And Error Handling - ReasonML By Example</h1><p style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:3.5rem;margin-top:-1.75rem;padding-bottom:1.3125rem;border-bottom:1px solid #121212">May 01, 2019</p><div><p><undefined>
  <a class="gatsby-resp-image-link" href="/static/95314e8408e8ba01449f564d9419082d/8e13f/rejs.jpg" style="display:block" target="_blank" rel="noopener">
  
  <span class="gatsby-resp-image-wrapper" style="position:relative;display:block;max-width:590px;margin-left:auto;margin-right:auto">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:74.95769881556684%;position:relative;bottom:0px;left:0px;background-size:cover;display:block">
      <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0px;vertical-align:middle;position:absolute;top:0px;left:0px;box-shadow:inset 0px 0px 0px 400px white" alt="ReasonML and JavaScript fusion" title="" src="/static/95314e8408e8ba01449f564d9419082d/c739e/rejs.jpg" srcSet="/static/95314e8408e8ba01449f564d9419082d/8ee9c/rejs.jpg 148w,/static/95314e8408e8ba01449f564d9419082d/ebbe7/rejs.jpg 295w,/static/95314e8408e8ba01449f564d9419082d/c739e/rejs.jpg 590w,/static/95314e8408e8ba01449f564d9419082d/5413e/rejs.jpg 885w,/static/95314e8408e8ba01449f564d9419082d/4efde/rejs.jpg 1180w,/static/95314e8408e8ba01449f564d9419082d/8e13f/rejs.jpg 1182w" sizes="(max-width: 590px) 100vw, 590px"/>
    </span>
  </span>
  
  </a>
    </undefined></p><p>While writing your app sometimes you will want to use some functions or values from javascript code (native or some libraries). Some functions are already provided like <code class="language-text">Js.log</code> and for others you will need to write bindings. This might sound like a chore and it kind of is a chore but I think it is worth it. Remember when TypeScript didn’t have a type declarations for every library in npm?</p><h2>Basic interop example</h2><p>To get to a variable <code class="language-text">Math.PI</code> from js we would write something like this:</p><div class="gatsby-highlight" data-language="reason"><pre class="language-reason"><code class="language-reason"><span class="token punctuation">[</span>@bs<span class="token punctuation">.</span><span class="token keyword">val</span><span class="token punctuation">]</span> <span class="token keyword">external</span> pi<span class="token punctuation">:</span> float <span class="token operator">=</span> <span class="token string">&quot;Math.PI&quot;</span><span class="token punctuation">;</span></code></pre></div><p>Let’s walk through this code. In here we declare external value called <code class="language-text">pi</code> that has a type of float. It looks like a <code class="language-text">let</code>, except that the value is a string and in this example that string is a value that we are binding to.</p><p>Now about this <code class="language-text">[@bs.val]</code> thing. It’s probably an unfamiliar syntax construction for you. It was for me at least.</p><h2>PPX</h2><p>PPX is a language feature of OCaml/Reason that allows to modify your code. You can think of it as a babel plugin. It essentially transforms Abstract Syntax Tree of your code.</p><p>For more documentation about PPX that bind js value head over <a href="https://bucklescript.github.io/bucklescript/Manual.html#_binding_to_simple_js_functions_values">here</a></p><h2>Performance</h2><p>Surely, you might thinking, this kind of mapping has some performance penalty but <code class="language-text">external</code>s are turned into expected values during compilation and completely erased. Let’s take a look at example with <code class="language-text">Math.PI</code>.</p><p><em>Example.re</em></p><div class="gatsby-highlight" data-language="reason"><pre class="language-reason"><code class="language-reason"><span class="token punctuation">[</span>@bs<span class="token punctuation">.</span><span class="token keyword">val</span><span class="token punctuation">]</span> <span class="token keyword">external</span> pi<span class="token punctuation">:</span> float <span class="token operator">=</span> <span class="token string">&quot;Math.PI&quot;</span><span class="token punctuation">;</span>

<span class="token class-name">Js</span><span class="token punctuation">.</span>log<span class="token punctuation">(</span>pi <span class="token operator">+.</span> pi<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>Here we use binding to <code class="language-text">Math.PI</code> value and log the sum.</p><p><em>Example.bs.js</em></p><div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span></code></pre></div><blockquote><p>In this post I omit comments and exports from generated javascript</p></blockquote><p>No traces of any bindings are present! The values were inlined as expected and the output isn’t that different from something that was written in JS manually.</p><h2>Canvas API</h2><p>This is a continuation of part 1 post, so if you haven’t that yet now is the time.</p><p>I want to visualize the quadtree implemented in previous post. For that I will use <a href="https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API">Canvas API</a> as it provides simple APIs for drawing primitive shapes like lines, rectangles and circles.</p><p>First of all we need to get canvas dom element. For that I’ll bind <code class="language-text">document.getElementById</code> function and assume that it will always return <code class="language-text">canvas</code> element. While this assumption is not particularly smart but for this little project it’ll get the job done.</p><p>First we need to define Canvas type.</p><p><em>Canvas.re</em></p><div class="gatsby-highlight" data-language="reason"><pre class="language-reason"><code class="language-reason"><span class="token keyword">type</span> t<span class="token punctuation">;</span></code></pre></div><p>And then lets bind <code class="language-text">document.getElementById</code> to <code class="language-text">getCanvasById</code> function.</p><p><em>Canvas.re</em></p><div class="gatsby-highlight" data-language="reason"><pre class="language-reason"><code class="language-reason"><span class="token keyword">type</span> t<span class="token punctuation">;</span>

<span class="token punctuation">[</span>@bs<span class="token punctuation">.</span><span class="token keyword">val</span><span class="token punctuation">]</span>
<span class="token keyword">external</span> getCanvasById<span class="token punctuation">:</span> string <span class="token operator">=&gt;</span> t <span class="token operator">=</span>
  <span class="token string">&quot;document.getElementById&quot;</span><span class="token punctuation">;</span></code></pre></div><p>As you can see from type signature it takes string (id) and returns value of type <code class="language-text">t</code> — canvas.</p><p>Lets test it and checkout the compiled js.</p><p>By default reasonml will remove unused code:</p><p><em>Canvas.bs.js</em></p><div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">/* This output is empty. Its source&#x27;s type definitions, externals and/or unused code got optimized away. */</span></code></pre></div><p>So to test it lets use it in some way</p><div class="gatsby-highlight" data-language="reason"><pre class="language-reason"><code class="language-reason"><span class="token keyword">let</span> canvas <span class="token operator">=</span> getCanvasById<span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>And the compiled js looks like this:</p><div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span></code></pre></div><p>Looks good to me. Now we need to get 2d context from canvas;</p><div class="gatsby-highlight" data-language="reason"><pre class="language-reason"><code class="language-reason"><span class="token keyword">type</span> context<span class="token punctuation">;</span>

<span class="token punctuation">[</span>@bs<span class="token punctuation">.</span>send<span class="token punctuation">]</span> <span class="token keyword">external</span> getContext<span class="token punctuation">:</span> <span class="token punctuation">(</span>t<span class="token punctuation">,</span> string<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> context <span class="token operator">=</span> <span class="token string">&quot;getContext&quot;</span><span class="token punctuation">;</span></code></pre></div><p>First we need to define type for context and then to define <code class="language-text">getContext</code> function.</p><p>There you can see <code class="language-text">[@bs.send]</code> ppx that will bind function in the following way. It will take first argument (<code class="language-text">t</code>) then will use method defined in the body (<code class="language-text">getContext</code>) and apply the rest of the arguments (<code class="language-text">string</code>) to that method.</p><p>So the result will look like this <code class="language-text">t.getContext(string)</code>.</p><p>If the body of a external is the same as a value’s name we can replace it with an empty string:</p><div class="gatsby-highlight" data-language="reason"><pre class="language-reason"><code class="language-reason"><span class="token punctuation">[</span>@bs<span class="token punctuation">.</span>send<span class="token punctuation">]</span> <span class="token keyword">external</span> getContext<span class="token punctuation">:</span> <span class="token punctuation">(</span>t<span class="token punctuation">,</span> string<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> context <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span></code></pre></div><h2>Error handling</h2><p>Let’s take a step back for a second. Both functions <code class="language-text">getElementById</code> and <code class="language-text">getContext</code> can return <code class="language-text">null</code> and it should be handled correctly. While writing it’s easy to say that “Ah it will probably never return null in real world” and that’s how unreliable code is born. With reason we don’t want to have runtime exceptions.</p><p>To correctly write bindings we need to include a path with failure.</p><p>My first idea was to make it return option.</p><div class="gatsby-highlight" data-language="reason"><pre class="language-reason"><code class="language-reason"><span class="token punctuation">[</span>@bs<span class="token punctuation">.</span><span class="token keyword">val</span><span class="token punctuation">]</span> <span class="token keyword">external</span> getCanvasById<span class="token punctuation">:</span> string <span class="token operator">=&gt;</span> option<span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;document.getElementById&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">switch</span> <span class="token punctuation">(</span>getCanvasById<span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token operator">|</span> <span class="token constructor variable">Some</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token class-name">Js</span><span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">&quot;There is a canvas!&quot;</span><span class="token punctuation">)</span>
<span class="token operator">|</span> <span class="token constructor variable">None</span> <span class="token operator">=&gt;</span> <span class="token class-name">Js</span><span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">&quot;There is no canvas :(&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div><p>Let’s look at the generated javascript and see why this won’t work as we need.</p><div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> match <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>match <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;There is a canvas!&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;There is no canvas :(&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div><p>What it does here is compares it to <code class="language-text">undefined</code> but <code class="language-text">getElementById</code> return <code class="language-text">null</code> when no node is found so this is a problem as <code class="language-text">null</code> doesn’t strictly equal to <code class="language-text">undefined</code>.</p><p>For handling both <code class="language-text">null</code> and <code class="language-text">undefined</code> there is a <code class="language-text">Js.Nullable</code> module that works similar to <code class="language-text">option</code> and in fact can be converted to option using <code class="language-text">Js.Nullable.toOption</code>.</p><div class="gatsby-highlight" data-language="reason"><pre class="language-reason"><code class="language-reason"><span class="token punctuation">[</span>@bs<span class="token punctuation">.</span><span class="token keyword">val</span><span class="token punctuation">]</span>
<span class="token keyword">external</span> getCanvasById<span class="token punctuation">:</span> string <span class="token operator">=&gt;</span> <span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Nullable</span><span class="token punctuation">.</span>t<span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token operator">=</span>
  <span class="token string">&quot;document.getElementById&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Nullable</span><span class="token punctuation">.</span>toOption<span class="token punctuation">(</span>getCanvasById<span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token operator">|</span> <span class="token constructor variable">Some</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token class-name">Js</span><span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">&quot;There is a canvas!&quot;</span><span class="token punctuation">)</span>
<span class="token operator">|</span> <span class="token constructor variable">None</span> <span class="token operator">=&gt;</span> <span class="token class-name">Js</span><span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">&quot;There is no canvas :(&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div><p>and in the generated code it uses non-strict equality operator <code class="language-text">==</code> to compare it against <code class="language-text">null</code> that will cover both <code class="language-text">undefined</code> and <code class="language-text">null</code> cases. Much better!</p><div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> match <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>match <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;There is no canvas :(&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;There is a canvas!&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div><p>But I actually don’t want to deal with additional type <code class="language-text">Js.Nullable</code> when there is <code class="language-text">option</code> type so I’ll just <a href="https://reasonml.github.io/docs/en/let-binding#bindings-are-immutable">shadow</a> them with functions that convert result to the <code class="language-text">option</code>.</p><div class="gatsby-highlight" data-language="reason"><pre class="language-reason"><code class="language-reason"><span class="token punctuation">[</span>@bs<span class="token punctuation">.</span><span class="token keyword">val</span><span class="token punctuation">]</span>
<span class="token keyword">external</span> getCanvasById<span class="token punctuation">:</span> string <span class="token operator">=&gt;</span> <span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Nullable</span><span class="token punctuation">.</span>t<span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token operator">=</span>
  <span class="token string">&quot;document.getElementById&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> getCanvasById <span class="token operator">=</span> id <span class="token operator">=&gt;</span> getCanvasById<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Nullable</span><span class="token punctuation">.</span>toOption<span class="token punctuation">;</span>

<span class="token punctuation">[</span>@bs<span class="token punctuation">.</span>send<span class="token punctuation">]</span> <span class="token keyword">external</span> getContext<span class="token punctuation">:</span> <span class="token punctuation">(</span>t<span class="token punctuation">,</span> string<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Nullable</span><span class="token punctuation">.</span>t<span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> getContext <span class="token operator">=</span> canvas <span class="token operator">=&gt;</span> getContext<span class="token punctuation">(</span>canvas<span class="token punctuation">,</span> <span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Nullable</span><span class="token punctuation">.</span>toOption<span class="token punctuation">;</span></code></pre></div><p>If you’re not familiar with fast pipe syntax <code class="language-text">-&gt;</code> it places left side as a first argument of a right side function.
And I also hardcoded value <code class="language-text">2d</code> as it is the only type of context that we’ll need in this example.</p><div class="gatsby-highlight" data-language="reason"><pre class="language-reason"><code class="language-reason">a<span class="token operator">-&gt;</span>b <span class="token comment">/* Both variants are the same */</span>
b<span class="token punctuation">(</span>a<span class="token punctuation">)</span></code></pre></div><p>So in the end we can write it like this:</p><div class="gatsby-highlight" data-language="reason"><pre class="language-reason"><code class="language-reason"><span class="token keyword">let</span> ctx <span class="token operator">=</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>getCanvasById<span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">|</span> <span class="token constructor variable">Some</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> getContext<span class="token punctuation">(</span>canvas<span class="token punctuation">)</span>
  <span class="token operator">|</span> <span class="token constructor variable">None</span> <span class="token operator">=&gt;</span> <span class="token constructor variable">None</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div><p>What we doing here is essentially chaining two functions <code class="language-text">getCanvasById</code> and <code class="language-text">getContext</code>. If we look at their signatures we can notice that they are kind of composable.</p><div class="gatsby-highlight" data-language="reason"><pre class="language-reason"><code class="language-reason">string <span class="token operator">=&gt;</span> option<span class="token punctuation">(</span><span class="token class-name">Canvas</span><span class="token punctuation">.</span>t<span class="token punctuation">)</span>
<span class="token class-name">Canvas</span><span class="token punctuation">.</span>t <span class="token operator">=&gt;</span> option<span class="token punctuation">(</span>context<span class="token punctuation">)</span></code></pre></div><p>If only there were no <code class="language-text">option</code>s we could write it as simple as <code class="language-text">getCanvasById(&quot;test&quot;)-&gt;getContext</code>.</p><p>For this pattern of chaining functions that return <code class="language-text">option</code> we can use <code class="language-text">Belt.Option.flatMap</code>. It takes value of type option and function that returns <code class="language-text">option</code> meaning there are two paths:</p><ul><li>happy path when there is Some value</li><li>error path with value None</li></ul><p>With <code class="language-text">flatMap</code> we can chain and handle this paths in a readable way.</p><div class="gatsby-highlight" data-language="reason"><pre class="language-reason"><code class="language-reason"><span class="token keyword">let</span> ctx <span class="token operator">=</span> getCanvasById<span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token class-name">Belt</span><span class="token punctuation">.</span><span class="token class-name">Option</span><span class="token punctuation">.</span>flatMap<span class="token punctuation">(</span>getContext<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><blockquote><p><a href="https://bucklescript.github.io/bucklescript/api/Belt.html">Belt</a> is a standard library that contains among other things collections like Set, Map, Hashset and utils like <code class="language-text">Belt.Option</code>.</p></blockquote><h2>Drawing shapes</h2><p>Lets bind <code class="language-text">strokeRect</code> function and try to draw something on the screen:</p><div class="gatsby-highlight" data-language="reason"><pre class="language-reason"><code class="language-reason"><span class="token punctuation">[</span>@bs<span class="token punctuation">.</span>send<span class="token punctuation">]</span>
<span class="token keyword">external</span> strokeRect<span class="token punctuation">:</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> float<span class="token punctuation">,</span> float<span class="token punctuation">,</span> float<span class="token punctuation">,</span> float<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> unit <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> draw <span class="token operator">=</span> ctx <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token operator">-&gt;</span>strokeRect<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">100.0</span><span class="token punctuation">,</span> <span class="token number">100.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> ctx <span class="token operator">=</span> getCanvasById<span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token class-name">Belt</span><span class="token punctuation">.</span><span class="token class-name">Option</span><span class="token punctuation">.</span>flatMap<span class="token punctuation">(</span>getContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">switch</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token operator">|</span> <span class="token constructor variable">Some</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> draw<span class="token punctuation">(</span>context<span class="token punctuation">)</span>
<span class="token operator">|</span> <span class="token constructor variable">None</span> <span class="token operator">=&gt;</span> <span class="token class-name">Js</span><span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">&quot;Failed to create context&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div><p>Now so far we have <code class="language-text">Canvas.re</code> file but we need to show that on an actual page so lets create <code class="language-text">index.html</code></p><div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>test<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./Canvas.re<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></code></pre></div><p>Where we include <code class="language-text">./Canvas.re</code>. And to compile this I’ll use <a href="https://parceljs.org/">parcel-bundler</a></p><p><undefined>
  <a class="gatsby-resp-image-link" href="/static/97f92a832522e1fc6699e254ca434a72/3658a/parcel.png" style="display:block" target="_blank" rel="noopener">
  
  <span class="gatsby-resp-image-wrapper" style="position:relative;display:block;max-width:590px;margin-left:auto;margin-right:auto">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:33.33333333333333%;position:relative;bottom:0px;left:0px;background-size:cover;display:block">
      <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0px;vertical-align:middle;position:absolute;top:0px;left:0px;box-shadow:inset 0px 0px 0px 400px white" alt="parcel" title="" src="/static/97f92a832522e1fc6699e254ca434a72/b9e4f/parcel.png" srcSet="/static/97f92a832522e1fc6699e254ca434a72/cf440/parcel.png 148w,/static/97f92a832522e1fc6699e254ca434a72/d2d38/parcel.png 295w,/static/97f92a832522e1fc6699e254ca434a72/b9e4f/parcel.png 590w,/static/97f92a832522e1fc6699e254ca434a72/3658a/parcel.png 762w" sizes="(max-width: 590px) 100vw, 590px"/>
    </span>
  </span>
  
  </a>
    </undefined></p><p><undefined>
  <a class="gatsby-resp-image-link" href="/static/41eec1eb810222d29105ad39af019c1f/4b160/rectangle.png" style="display:block" target="_blank" rel="noopener">
  
  <span class="gatsby-resp-image-wrapper" style="position:relative;display:block;max-width:590px;margin-left:auto;margin-right:auto">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:70.2576112412178%;position:relative;bottom:0px;left:0px;background-size:cover;display:block">
      <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0px;vertical-align:middle;position:absolute;top:0px;left:0px;box-shadow:inset 0px 0px 0px 400px white" alt="rectangle" title="" src="/static/41eec1eb810222d29105ad39af019c1f/b9e4f/rectangle.png" srcSet="/static/41eec1eb810222d29105ad39af019c1f/cf440/rectangle.png 148w,/static/41eec1eb810222d29105ad39af019c1f/d2d38/rectangle.png 295w,/static/41eec1eb810222d29105ad39af019c1f/b9e4f/rectangle.png 590w,/static/41eec1eb810222d29105ad39af019c1f/4b160/rectangle.png 854w" sizes="(max-width: 590px) 100vw, 590px"/>
    </span>
  </span>
  
  </a>
    </undefined></p><h2>Drawing tree</h2><p>And the rest of the code for drawing a tree. There are no new language features here so it should be quite straightforward to understand.</p><div class="gatsby-highlight" data-language="reason"><pre class="language-reason"><code class="language-reason"><span class="token punctuation">[</span>@bs<span class="token punctuation">.</span>send<span class="token punctuation">]</span>
<span class="token keyword">external</span> clearRect<span class="token punctuation">:</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> float<span class="token punctuation">,</span> float<span class="token punctuation">,</span> float<span class="token punctuation">,</span> float<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> unit <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

<span class="token operator">/</span><span class="token operator">/</span> <span class="token constructor variable">Define</span> screen size
<span class="token keyword">let</span> size <span class="token operator">=</span> <span class="token number">512.0</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> drawTree <span class="token operator">=</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> tree<span class="token punctuation">:</span> <span class="token class-name">Tree</span><span class="token punctuation">.</span>t<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token operator">/</span><span class="token operator">/</span> <span class="token constructor variable">Clear</span> all screen
  ctx<span class="token operator">-&gt;</span>clearRect<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> size<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> <span class="token keyword">rec</span> step <span class="token operator">=</span> <span class="token punctuation">(</span>tree<span class="token punctuation">:</span> <span class="token class-name">Tree</span><span class="token punctuation">.</span>t<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> point <span class="token operator">=</span> tree<span class="token punctuation">.</span>bbox<span class="token punctuation">.</span>topLeft<span class="token punctuation">;</span>
    <span class="token keyword">let</span> side <span class="token operator">=</span> tree<span class="token punctuation">.</span>bbox<span class="token punctuation">.</span>side<span class="token punctuation">;</span>
    <span class="token operator">/</span><span class="token operator">/</span> <span class="token constructor variable">Draw</span> bounding box
    ctx<span class="token operator">-&gt;</span>strokeRect<span class="token punctuation">(</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span> point<span class="token punctuation">.</span>y<span class="token punctuation">,</span> side<span class="token punctuation">,</span> side<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">/</span><span class="token operator">/</span> <span class="token constructor variable">Draw</span> body <span class="token keyword">if</span> present
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>tree<span class="token punctuation">.</span>body<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">|</span> <span class="token constructor variable">Some</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ctx<span class="token operator">-&gt;</span>strokeRect<span class="token punctuation">(</span>b<span class="token punctuation">.</span>pos<span class="token punctuation">.</span>x<span class="token punctuation">,</span> b<span class="token punctuation">.</span>pos<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span>
    <span class="token operator">|</span> <span class="token constructor variable">None</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token operator">/</span><span class="token operator">/</span> <span class="token constructor variable">Recursively</span> draw children
    <span class="token class-name">Tree</span><span class="token punctuation">.</span>forEachChild<span class="token punctuation">(</span>tree<span class="token punctuation">,</span> step<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  step<span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> ctx <span class="token operator">=</span> getCanvasById<span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token class-name">Belt</span><span class="token punctuation">.</span><span class="token class-name">Option</span><span class="token punctuation">.</span>flatMap<span class="token punctuation">(</span>getContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> tree <span class="token operator">=</span> <span class="token class-name">Tree</span><span class="token punctuation">.</span>makeRandom<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Js</span><span class="token punctuation">.</span>log<span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">switch</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token operator">|</span> <span class="token constructor variable">Some</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> drawTree<span class="token punctuation">(</span>context<span class="token punctuation">,</span> tree<span class="token punctuation">)</span>
<span class="token operator">|</span> <span class="token constructor variable">None</span> <span class="token operator">=&gt;</span> <span class="token class-name">Js</span><span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">&quot;Failed to create context&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div><p>And here is the result</p><p><undefined>
  <a class="gatsby-resp-image-link" href="/static/563d2ecdf34077ca0d80d3e49d492c85/5b907/quadtree.png" style="display:block" target="_blank" rel="noopener">
  
  <span class="gatsby-resp-image-wrapper" style="position:relative;display:block;max-width:590px;margin-left:auto;margin-right:auto">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:99.8116760828625%;position:relative;bottom:0px;left:0px;background-size:cover;display:block">
      <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0px;vertical-align:middle;position:absolute;top:0px;left:0px;box-shadow:inset 0px 0px 0px 400px white" alt="quadtree" title="" src="/static/563d2ecdf34077ca0d80d3e49d492c85/b9e4f/quadtree.png" srcSet="/static/563d2ecdf34077ca0d80d3e49d492c85/cf440/quadtree.png 148w,/static/563d2ecdf34077ca0d80d3e49d492c85/d2d38/quadtree.png 295w,/static/563d2ecdf34077ca0d80d3e49d492c85/b9e4f/quadtree.png 590w,/static/563d2ecdf34077ca0d80d3e49d492c85/f9b6a/quadtree.png 885w,/static/563d2ecdf34077ca0d80d3e49d492c85/5b907/quadtree.png 1062w" sizes="(max-width: 590px) 100vw, 590px"/>
    </span>
  </span>
  
  </a>
    </undefined></p><h2>Final code</h2><p>Right now it’s a bit messy because it contains parts of code that have different responsibilities, for example binding and tree drawing, but for educational purposes, I think, it’s better to read everything in one file like a book.</p><div class="gatsby-highlight" data-language="reason"><pre class="language-reason"><code class="language-reason"><span class="token keyword">type</span> t<span class="token punctuation">;</span>
<span class="token keyword">type</span> context<span class="token punctuation">;</span>

<span class="token punctuation">[</span>@bs<span class="token punctuation">.</span><span class="token keyword">val</span><span class="token punctuation">]</span>
<span class="token keyword">external</span> getCanvasById<span class="token punctuation">:</span> string <span class="token operator">=&gt;</span> <span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Nullable</span><span class="token punctuation">.</span>t<span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token operator">=</span>
  <span class="token string">&quot;document.getElementById&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> getCanvasById <span class="token operator">=</span> id <span class="token operator">=&gt;</span> getCanvasById<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Nullable</span><span class="token punctuation">.</span>toOption<span class="token punctuation">;</span>

<span class="token punctuation">[</span>@bs<span class="token punctuation">.</span>send<span class="token punctuation">]</span> <span class="token keyword">external</span> getContext<span class="token punctuation">:</span> <span class="token punctuation">(</span>t<span class="token punctuation">,</span> string<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Nullable</span><span class="token punctuation">.</span>t<span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> getContext <span class="token operator">=</span> canvas <span class="token operator">=&gt;</span> getContext<span class="token punctuation">(</span>canvas<span class="token punctuation">,</span> <span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Nullable</span><span class="token punctuation">.</span>toOption<span class="token punctuation">;</span>

<span class="token punctuation">[</span>@bs<span class="token punctuation">.</span>send<span class="token punctuation">]</span>
<span class="token keyword">external</span> strokeRect<span class="token punctuation">:</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> float<span class="token punctuation">,</span> float<span class="token punctuation">,</span> float<span class="token punctuation">,</span> float<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> unit <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span>@bs<span class="token punctuation">.</span>send<span class="token punctuation">]</span>
<span class="token keyword">external</span> clearRect<span class="token punctuation">:</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> float<span class="token punctuation">,</span> float<span class="token punctuation">,</span> float<span class="token punctuation">,</span> float<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> unit <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

<span class="token operator">/</span><span class="token operator">/</span> <span class="token constructor variable">Define</span> screen size
<span class="token keyword">let</span> size <span class="token operator">=</span> <span class="token number">512.0</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> drawTree <span class="token operator">=</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> tree<span class="token punctuation">:</span> <span class="token class-name">Tree</span><span class="token punctuation">.</span>t<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token operator">/</span><span class="token operator">/</span> <span class="token constructor variable">Clear</span> all screen
  ctx<span class="token operator">-&gt;</span>clearRect<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> size<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> <span class="token keyword">rec</span> step <span class="token operator">=</span> <span class="token punctuation">(</span>tree<span class="token punctuation">:</span> <span class="token class-name">Tree</span><span class="token punctuation">.</span>t<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> point <span class="token operator">=</span> tree<span class="token punctuation">.</span>bbox<span class="token punctuation">.</span>topLeft<span class="token punctuation">;</span>
    <span class="token keyword">let</span> side <span class="token operator">=</span> tree<span class="token punctuation">.</span>bbox<span class="token punctuation">.</span>side<span class="token punctuation">;</span>
    <span class="token operator">/</span><span class="token operator">/</span> <span class="token constructor variable">Draw</span> bounding box
    ctx<span class="token operator">-&gt;</span>strokeRect<span class="token punctuation">(</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span> point<span class="token punctuation">.</span>y<span class="token punctuation">,</span> side<span class="token punctuation">,</span> side<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">/</span><span class="token operator">/</span> <span class="token constructor variable">Draw</span> body <span class="token keyword">if</span> present
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>tree<span class="token punctuation">.</span>body<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">|</span> <span class="token constructor variable">Some</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ctx<span class="token operator">-&gt;</span>strokeRect<span class="token punctuation">(</span>b<span class="token punctuation">.</span>pos<span class="token punctuation">.</span>x<span class="token punctuation">,</span> b<span class="token punctuation">.</span>pos<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span>
    <span class="token operator">|</span> <span class="token constructor variable">None</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token operator">/</span><span class="token operator">/</span> <span class="token constructor variable">Recursively</span> draw children
    <span class="token class-name">Tree</span><span class="token punctuation">.</span>forEachChild<span class="token punctuation">(</span>tree<span class="token punctuation">,</span> step<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  step<span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> ctx <span class="token operator">=</span> getCanvasById<span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token class-name">Belt</span><span class="token punctuation">.</span><span class="token class-name">Option</span><span class="token punctuation">.</span>flatMap<span class="token punctuation">(</span>getContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> tree <span class="token operator">=</span> <span class="token class-name">Tree</span><span class="token punctuation">.</span>makeRandom<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Js</span><span class="token punctuation">.</span>log<span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">switch</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token operator">|</span> <span class="token constructor variable">Some</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> drawTree<span class="token punctuation">(</span>context<span class="token punctuation">,</span> tree<span class="token punctuation">)</span>
<span class="token operator">|</span> <span class="token constructor variable">None</span> <span class="token operator">=&gt;</span> <span class="token class-name">Js</span><span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">&quot;Failed to create context&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></div><div></div><hr style="margin-bottom:1.75rem"/><div style="display:flex;margin-bottom:4.375rem"><p>Blog by<!-- --> <a href="https://twitter.com/dubenko_">Oleksandr Dubenko</a></p></div><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/life-after-google/">← <!-- -->Life After Google — Map For Your Web App</a></li><li><a rel="next" href="/getting-started-with-reason-react/">Getting Started With ReasonReact. Now With Hooks!<!-- --> →</a></li></ul></main><footer></footer></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-138671614-1', 'auto', {});
      
      
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"reason-by-example-2-786","path":"/reason-by-example-2/"};window.dataPath="271/path---reason-by-example-2-786-ea5-lituBrqrWSGYtv3EBns36JNbgE";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-898795e671bc05935a90.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-573928976ec2dba9e470.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-d6c4ff3997a89bd5bda3.js"],"component---src-pages-404-js":["/component---src-pages-404-js-41338686d82be97b5ae9.js"],"component---src-pages-index-js":["/component---src-pages-index-js-be0a80ae1b9fbdb3d5d5.js"],"pages-manifest":["/pages-manifest-935e468b59875ac561e2.js"]};/*]]>*/</script><script src="/webpack-runtime-e5556ddc2c858ebe804f.js" async=""></script><script src="/styles-fb3fb444cf5b3d203f66.js" async=""></script><script src="/app-898795e671bc05935a90.js" async=""></script><script src="/1-1548207ea9ee4c2f8cde.js" async=""></script><script src="/component---src-templates-blog-post-js-d6c4ff3997a89bd5bda3.js" async=""></script></body></html>